{% extends 'base.html.twig' %}

{% block title %}Dashboard Admin{% endblock %}

{% block body %}
<div style="max-width: 1200px; margin: 2rem auto; padding: 0 1rem;">
    <h1 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1.5rem;">Dashboard Administrateur</h1>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
        <!-- Gestion des utilisateurs -->
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1.5rem;">
            <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">Gestion des utilisateurs</h2>
            <p style="color: #6b7280; margin-bottom: 1rem;">Gérer les inscriptions et les comptes utilisateurs</p>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <a href="{{ path('admin_pending_users') }}" 
                   style="padding: 0.75rem 1rem; background: #2563eb; color: white; border-radius: 4px; text-decoration: none; text-align: center; hover: background: #1d4ed8;">
                    Utilisateurs en attente ({{ pendingUsers|length }})
                </a>
                <a href="{{ path('admin_dashboard') }}" 
                   style="padding: 0.75rem 1rem; background: #6b7280; color: white; border-radius: 4px; text-decoration: none; text-align: center; hover: background: #4b5563;">
                    Tous les utilisateurs
                </a>
            </div>
        </div>

        <!-- Gestion des écoles -->
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1.5rem;">
            <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">Gestion des écoles</h2>
            <p style="color: #6b7280; margin-bottom: 1rem;">Gérer les écoles et les suggestions</p>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <a href="{{ path('admin_ecole_suggestion_list') }}" 
                   style="padding: 0.75rem 1rem; background: #2563eb; color: white; border-radius: 4px; text-decoration: none; text-align: center; hover: background: #1d4ed8;">
                    Suggestions d'écoles ({{ pendingSuggestions|length }})
                </a>
                <a href="{{ path('admin_ecole_ajouter') }}"style="padding: 0.75rem 1rem; background: #6b7280; color: white; border-radius: 4px; text-decoration: none; text-align: center; hover: background: #4b5563;">Gérer les écoles</a>
            </div>
        </div>

        <!-- Gestion des enfants -->
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1.5rem;">
            <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">Gestion des enfants</h2>
            <p style="color: #6b7280; margin-bottom: 1rem;">Valider les certificats de scolarité</p>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <a href="{{ path('admin_enfants_pending') }}" 
                   style="padding: 0.75rem 1rem; background: #2563eb; color: white; border-radius: 4px; text-decoration: none; text-align: center; hover: background: #1d4ed8;">
                    Enfants en attente de validation
                </a>
            </div>
        </div>
    </div>

    {% if pendingUsers is not empty %}
        <div style="margin-top: 2rem;">
            <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">Utilisateurs en attente d'approbation</h2>
            <div style="display: grid; gap: 1rem;">
                {% for user in pendingUsers %}
                    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="font-weight: 600; margin: 0 0 0.25rem 0;">{{ user.prenom }} {{ user.nom }}</h3>
                                <p style="color: #6b7280; margin: 0; font-size: 0.875rem;">{{ user.email }}</p>
                                <p style="color: #6b7280; margin: 0.25rem 0 0 0; font-size: 0.875rem;">
                                    Rôle: {{ user.role }}{% if user.roleAutre %} ({{ user.roleAutre }}){% endif %}
                                </p>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <a href="{{ path('admin_view_user', {'id': user.id}) }}" 
                                   style="padding: 0.5rem 1rem; background: #3b82f6; color: white; border-radius: 4px; text-decoration: none; font-size: 0.875rem; hover: background: #2563eb;">
                                    Voir détails
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}

    {% if pendingSuggestions is not empty %}
        <div style="margin-top: 2rem;">
            <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">Suggestions d'écoles en attente</h2>
            <div style="display: grid; gap: 1rem;">
                {% for suggestion in pendingSuggestions %}
                    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="font-weight: 600; margin: 0 0 0.25rem 0;">{{ suggestion.nom }}</h3>
                                <p style="color: #6b7280; margin: 0; font-size: 0.875rem;">{{ suggestion.adresse }}, {{ suggestion.ville }} {{ suggestion.codePostal }}</p>
                                <p style="color: #6b7280; margin: 0.25rem 0 0 0; font-size: 0.875rem;">
                                    Proposé par: {{ suggestion.createdBy.email }}
                                </p>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <a href="{{ path('admin_ecole_suggestion_list') }}" 
                                   style="padding: 0.5rem 1rem; background: #3b82f6; color: white; border-radius: 4px; text-decoration: none; font-size: 0.875rem; hover: background: #2563eb;">
                                    Gérer
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}